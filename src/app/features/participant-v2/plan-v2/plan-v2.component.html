<div class="header">
    <div class="tabWrapper">
        <ul>
          <li class="tabHead active" (click)="goToPlan()" routerLinkActive="active">
            <a class="tab-item" id="usefulContacts" attr.aria-label="tab Month">Plan</a>
          </li>
          <li class="tabHead " (click)="goToGoalsAndActions()"
            [routerLink]="['/person-supported/plan-v2/app-add-goals']" routerLinkActive="active"
            queryParamsHandling="merge">
            <a class="tab-item" id="usefulContacts" attr.aria-label="tab Month">Goals and Actions</a>
          </li>
        </ul>
      </div>
</div>
<div class="grid-row nomargin">
    <mat-card id='assessments'>
        <mat-card-header>
            <span class="spacer"></span>
            <span>
                <button id="edit_view_button" mat-stroked-button color="primary" (click)="createPlan()">Create a
                    plan</button>
            </span>
        </mat-card-header>
        <mat-card-content class="assessments_container">
            <p *ngIf="allAssessments.length==0" class="mat-dialog-title alignment"> Person supported currently has no plans created. </p>
            <mat-table *ngIf="allAssessments.length >0" id="assessment_table" #table [dataSource]="dataSource"
                class="isMobile">

                <ng-container matColumnDef="assessmentName">
                    <mat-header-cell *matHeaderCellDef id="template_name_button" class="assessmentName width-40">
                        Plan Name
                    </mat-header-cell>
                    <mat-cell *matCellDef="let element" class="assessmentName width-40"><span
                            class="mobile-label">Assessments:
                        </span>
                        {{element.assessmentName}}
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="createdDate">
                    <mat-header-cell class="width-15" *matHeaderCellDef id="date_created_button"> Date Created
                    </mat-header-cell>
                    <mat-cell class="width-15" *matCellDef="let element"><span class="mobile-label">Date Assigned:
                        </span>
                        {{element.createdDate | customMonthFormat }} </mat-cell>
                </ng-container>

                <ng-container matColumnDef="modifiedDate">
                    <mat-header-cell class="width-15" *matHeaderCellDef id="date_created_button"> Next Review Date
                    </mat-header-cell>
                    <mat-cell class="width-15" *matCellDef="let element"><span class="mobile-label">Next Review Date:
                        </span>
                       {{ element.reviewDate ? (element.reviewDate | customMonthFormat) : 'N/A' }}
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="status">
                    <mat-header-cell class="width-15" *matHeaderCellDef id="date_created_button"> Status
                    </mat-header-cell>
                    <mat-cell class="width-15" *matCellDef="let element">
                        <span class="mobile-label call-status-label">Status:</span>
                        <span class="status"> {{element.status}}</span>
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <mat-header-cell *matHeaderCellDef class="actions-column">Action</mat-header-cell>
                    <mat-cell *matCellDef="let element" class="actions-column"> <span class="mobile-label"></span>

                        <button *ngIf="isAuthorized(123,2)"
                            id="view_assessment_button_{{element.assessmentTemplateUserId}}" mat-icon-button
                            color="primary" [routerLink]="['./view-plan']"
                            [queryParams]="{ id : userId,  name:fname, assessmentTemplateId: element.assessmentTemplateId, assessmentTemplateUserId: element.assessmentTemplateUserId, isCompleted: element.status }"
                            queryParamsHandling="merge" title="View" attr.aria-label="View {{element.assessmentName}} " (click)="customuw()">
                            <mat-icon>visibility</mat-icon>
                        </button>

                        <button *ngIf="!element.isCompleted && isAuthorized(123,3)"
                            id="edit_assessment_button_{{element.assessmentTemplateUserId}}" mat-icon-button
                            color="primary"
                            (click)="navigateToEdit(element.assessmentTemplateId, element.assessmentType,element.assessmentTemplateUserId,element.status)"
                            title="Edit" attr.aria-label="Edit {{element.assessmentName}}" [disabled]="element.status ==='End of course review'">
                            <mat-icon>create</mat-icon>
                        </button>

                        <button *ngIf="!element.isCompleted && isAuthorized(123, 4)"
                            id="delete_assessment_button_{{element.assessmentTemplateUserId}}" mat-icon-button
                            (click)="onDeleteClicked(element.assessmentTemplateUserId, element.assessmentTemplateId)"
                            title="Delete" attr.aria-label="Delete {{element.assessmentName}}" color="accent"
                            [disabled]="element.status ==='End of course review'">
                            <mat-icon>delete</mat-icon>
                        </button>

                    </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
            </mat-table>

            <mat-paginator #paginator id="assessments_pagination" [pageSize]="size" [showFirstLastButtons]='true' [hidePageSize]="true" (page)='onPaginateChange($event)'>
            </mat-paginator>
        </mat-card-content>
    </mat-card>
</div>