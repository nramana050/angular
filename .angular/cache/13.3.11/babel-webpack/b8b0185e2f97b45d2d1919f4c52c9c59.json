{"ast":null,"code":"import Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"src/app/GobalAPIService/global-service-service/PreviewService\";\nimport * as i4 from \"../email-management-service/email-manaement.service\";\nimport * as i5 from \"@angular/forms\";\n\nfunction ConfigurationComponent_div_54_div_1_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 20);\n    i0.ɵɵtext(1, \"Please enter email id\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ConfigurationComponent_div_54_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, ConfigurationComponent_div_54_div_1_p_1_Template, 2, 0, \"p\", 14);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext(2);\n\n    const _r1 = i0.ɵɵreference(52);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r1.errors == null ? null : _r1.errors.required);\n  }\n}\n\nfunction ConfigurationComponent_div_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, ConfigurationComponent_div_54_div_1_Template, 2, 1, \"div\", 13);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r1 = i0.ɵɵreference(52);\n\n    const _r0 = i0.ɵɵreference(45);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r1.touched || _r0.submitted);\n  }\n}\n\nfunction ConfigurationComponent_p_56_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Invalid id: \", ctx_r3.invalidId, \"\");\n  }\n}\n\nexport let ConfigurationComponent = /*#__PURE__*/(() => {\n  class ConfigurationComponent {\n    constructor(router, location, previewService, emailService) {\n      this.router = router;\n      this.location = location;\n      this.previewService = previewService;\n      this.emailService = emailService;\n      this.ConfigShowData = {};\n      this.sendMailTestObj = {};\n      this.SendTestMailList = [];\n      this.userInfo = {\n        testMail: \"\",\n        campaignSkey: \"\"\n      };\n      this.updateSendMailObj = {};\n      this.invalidIdFlg = false;\n      this.invalidId = \"\";\n      this.backButtonData = this.previewService.selecteCampaignIdList;\n\n      if (this.backButtonData == null || this.backButtonData == undefined || this.backButtonData == \"\") {\n        this.router.navigate(['/campaign-management']);\n      }\n\n      this.getAllList();\n      this.getAllSenderList();\n      this.getAllTemplateList();\n    }\n\n    ngOnInit() {\n      this.customerId = sessionStorage.getItem(\"customerId\");\n\n      if (this.customerId == null || this.customerId == undefined || this.customerId == \"\") {\n        this.router.navigate(['/campaign-management']);\n      }\n    }\n\n    setConfiguration() {\n      this.ConfigurationData = this.previewService.selecteCampaignIdList; // set List anme\n\n      let Listname = \"\";\n\n      for (let i in this.ConfigurationData.campaignListMap) {\n        for (let r in this.ListData) {\n          if (this.ListData[r].listId == this.ConfigurationData.campaignListMap[i].listId) {\n            Listname = Listname + \",\" + this.ListData[r].listName;\n          }\n        }\n      }\n\n      var myListName = Listname;\n\n      if (myListName.charAt(0) === ',') {\n        myListName = myListName.slice(1);\n        this.ConfigShowData.configList = myListName;\n      } // set subject\n\n\n      this.ConfigShowData.configSubject = this.ConfigurationData.campaign.subject; //\n\n      this.ConfigShowData.scheduleCampaign = this.ConfigurationData.campaign.scheduleCampaign; //email template\n\n      for (let r in this.templateData) {\n        if (this.templateData[r].emailTemplateSkey == this.ConfigurationData.campaign.emailTemplateSkey) {\n          this.ConfigShowData.templateName = this.templateData[r].templateName;\n        }\n      } // sender\n\n\n      for (let r in this.senderData) {\n        if (this.senderData[r].senderId == this.ConfigurationData.campaign.senderId) {\n          this.ConfigShowData.senderEmail = this.senderData[r].emailAddress;\n        }\n      }\n    }\n\n    getAllTemplateList() {\n      let resp = this.emailService.getAllTemplateList();\n      resp.subscribe(data => {\n        if (data != 0) {\n          this.templateData = data;\n        }\n      });\n    }\n\n    getAllList() {\n      let resp = this.emailService.getAllList();\n      resp.subscribe(data => {\n        if (data != 0) {\n          this.ListData = data;\n          this.getAllSenderList();\n        }\n      });\n    }\n\n    getAllSenderList() {\n      let resp = this.emailService.getAllSenderList();\n      resp.subscribe(data => {\n        if (data != 0) {\n          if (this.previewService.selecteCampaignIdList != null && this.previewService.selecteCampaignIdList != undefined) {\n            this.senderData = data;\n            this.setConfiguration();\n          }\n        }\n      });\n    }\n\n    redirectToCampignmanagement() {\n      this.router.navigate(['/campaign-management']);\n    } // back button set data to service.\n\n\n    redirectToCreateCampign() {\n      this.previewService.selecteCampaignIdList = this.backButtonData;\n      this.previewService.selectedCampaignIdListRouting = null;\n      this.previewService.selectedroutingList = null;\n      sessionStorage.setItem(\"Clone\", null);\n      this.router.navigate(['/create-campaign']);\n    }\n\n    sendCampaign() {\n      this.updateSendMailObj = {};\n\n      if (this.ConfigShowData.scheduleCampaign == \"scheduleLater\") {\n        this.updateSendMailObj.campaignSkey = this.ConfigurationData.campaign.campaignSkey;\n        this.updateSendMailObj.campaignStatus = \"Sheduled\";\n      } else {\n        this.updateSendMailObj.campaignStatus = \"Send\";\n        this.updateSendMailObj.campaignSkey = this.ConfigurationData.campaign.campaignSkey;\n      }\n\n      let msg = '';\n      let BtnMsg = '';\n      msg = \"Do you want to send this campaign?\";\n      BtnMsg = \"Send\";\n      Swal.fire({\n        title: 'Are You Sure?',\n        text: msg,\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        confirmButtonText: 'Yes, ' + BtnMsg + ' it'\n      }).then(result => {\n        if (result.isConfirmed) {\n          let resp = this.emailService.sendMailCampaign(this.updateSendMailObj);\n          resp.subscribe(data => {\n            if (data == 0 || data == 1) {\n              this.router.navigate(['/dashboard']);\n              Swal.fire('Send', 'Your campaign has been sent successfully', 'success');\n            }\n          });\n        }\n      });\n    }\n\n    sendTestMail(testMailForm) {\n      this.invalidInput = false;\n      var filesArray;\n\n      if (this.userInfo.testMail) {\n        if (this.userInfo.testMail.includes(\"@\")) {\n          this.userInfo.testMail = this.userInfo.testMail;\n\n          if (this.userInfo.testMail.split('@').length - 1 <= 3) {\n            if (this.userInfo.testMail.includes(\",\")) {\n              filesArray = this.userInfo.testMail.split(',');\n            } else if (this.userInfo.testMail.includes(\" \")) {\n              filesArray = this.userInfo.testMail.split(' ');\n            } else {\n              filesArray = this.userInfo.testMail.split(' ');\n            }\n\n            if (this.userInfo.testMail.includes(\"|\") || this.userInfo.testMail.includes(\"-\") || this.userInfo.testMail.includes(\":\")) {\n              this.invalidInput = true;\n            }\n\n            if (this.invalidInput == false) {\n              this.sendMailTestObj = {};\n              this.SendTestMailList = [];\n              let flg = 0;\n              this.invalidIdFlg = false;\n              this.invalidId = \"\";\n\n              for (var i in filesArray) {\n                var mailLIst = filesArray[i].split(\"@\");\n\n                if (filesArray[i].includes(\"@\")) {\n                  this.sendMailTestObj.testMail = JSON.parse(JSON.stringify(filesArray[i]));\n                  this.sendMailTestObj.campaignSkey = JSON.parse(JSON.stringify(this.ConfigurationData.campaign.campaignSkey));\n                  this.sendMailTestObj.customerId = this.customerId;\n                  this.sendMailTestObj.subject = this.ConfigShowData.configSubject;\n                  this.sendMailTestObj.sendFrom = this.ConfigShowData.senderEmail;\n                  this.SendTestMailList.push(JSON.parse(JSON.stringify(this.sendMailTestObj)));\n                } else {\n                  this.invalidId = JSON.stringify(filesArray[i]);\n                  this.invalidIdFlg = true;\n                  flg = 1;\n                }\n              }\n\n              if (flg == 0) {\n                let resp = this.emailService.sendTestMail(this.SendTestMailList);\n                resp.subscribe(data => {\n                  if (data == 0 || data == 1) {\n                    this.userInfo.testMail = \"\";\n                    testMailForm.resetForm();\n                    Swal.fire('Send', 'Your test mail has been sent successfully', 'success');\n                  }\n                });\n              } else {// error active\n              }\n            } else {\n              Swal.fire(\"Please enter email Id seperated by ',' ' '\");\n            }\n          } else {\n            Swal.fire(\"You can't test more than 3 email Id\");\n          }\n        } else {\n          Swal.fire(\"Please enter valid email Id\");\n        }\n      } else {\n        Swal.fire(\"Please enter email Id\");\n      }\n    }\n\n  }\n\n  ConfigurationComponent.ɵfac = function ConfigurationComponent_Factory(t) {\n    return new (t || ConfigurationComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.Location), i0.ɵɵdirectiveInject(i3.PreviewService), i0.ɵɵdirectiveInject(i4.EmailManaementService));\n  };\n\n  ConfigurationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConfigurationComponent,\n    selectors: [[\"app-configuration\"]],\n    decls: 75,\n    vars: 7,\n    consts: [[1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [1, \"text-info\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-check-square-o\"], [1, \"dropdown\", \"m-2\", \"d-flex\"], [1, \"mr-3\", \"mt-3\"], [1, \"m-2\"], [\"novalidate\", \"\", \"autocomplete\", \"off\", 1, \"w-100\", 3, \"ngSubmit\"], [\"testMailForm\", \"ngForm\"], [1, \"m-4\"], [\"rows\", \"4\", \"id\", \"testMail\", \"placeholder\", \"Enter Email Id\", \"ng-maxlength\", \"255\", \"name\", \"testMail\", \"required\", \"\", 1, \"form-control\", \"w-50\", 3, \"ngModel\", \"ngModelChange\"], [\"testMail\", \"ngModel\"], [4, \"ngIf\"], [\"class\", \"help-box\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-info\", \"mr-3\", \"mt-3\", \"text-center\"], [\"type\", \"submit\", 1, \"btn\", \"btn-warning\", 3, \"click\"], [1, \"cursor\", \"text-light\"], [\"type\", \"submit\", 1, \"btn\", \"btn-info\", \"float-right\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-danger\", \"float-right\", \"mr-2\", 3, \"click\"], [1, \"help-box\"]],\n    template: function ConfigurationComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r6 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"strong\");\n        i0.ɵɵtext(3, \"Configuration\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"h5\", 3)(6, \"strong\");\n        i0.ɵɵelement(7, \"i\", 4);\n        i0.ɵɵtext(8, \" Setup\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 5)(10, \"div\", 6)(11, \"strong\");\n        i0.ɵɵtext(12, \"Sent From :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(14, \"hr\");\n        i0.ɵɵelementStart(15, \"div\")(16, \"h5\", 3)(17, \"strong\");\n        i0.ɵɵelement(18, \"i\", 4);\n        i0.ɵɵtext(19, \" Receipient\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"div\", 7)(21, \"strong\");\n        i0.ɵɵtext(22, \"Mailing List : \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(23);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(24, \"hr\");\n        i0.ɵɵelementStart(25, \"div\")(26, \"div\", 7)(27, \"strong\");\n        i0.ɵɵtext(28, \"Subject : \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"span\");\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(31, \"hr\");\n        i0.ɵɵelementStart(32, \"div\")(33, \"h5\", 3)(34, \"strong\");\n        i0.ɵɵelement(35, \"i\", 4);\n        i0.ɵɵtext(36, \" Design\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(37, \"div\", 7)(38, \"strong\");\n        i0.ɵɵtext(39, \"Template Name : \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"span\");\n        i0.ɵɵtext(41);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(42, \"hr\");\n        i0.ɵɵelementStart(43, \"div\")(44, \"form\", 8, 9);\n        i0.ɵɵlistener(\"ngSubmit\", function ConfigurationComponent_Template_form_ngSubmit_44_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r0 = i0.ɵɵreference(45);\n\n          return _r0.form.valid && ctx.sendTestMail(_r0);\n        });\n        i0.ɵɵelementStart(46, \"h5\", 3)(47, \"strong\");\n        i0.ɵɵelement(48, \"i\", 4);\n        i0.ɵɵtext(49, \" Add Test Mails\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(50, \"div\", 10)(51, \"textarea\", 11, 12);\n        i0.ɵɵlistener(\"ngModelChange\", function ConfigurationComponent_Template_textarea_ngModelChange_51_listener($event) {\n          return ctx.userInfo.testMail = $event;\n        });\n        i0.ɵɵtext(53, \" \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(54, ConfigurationComponent_div_54_Template, 2, 1, \"div\", 13);\n        i0.ɵɵelementStart(55, \"div\");\n        i0.ɵɵtemplate(56, ConfigurationComponent_p_56_Template, 2, 1, \"p\", 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(57, \"button\", 15)(58, \"strong\");\n        i0.ɵɵtext(59, \"Send Test Mail \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(60, \"hr\");\n        i0.ɵɵelementStart(61, \"div\")(62, \"button\", 16);\n        i0.ɵɵlistener(\"click\", function ConfigurationComponent_Template_button_click_62_listener() {\n          return ctx.redirectToCreateCampign();\n        });\n        i0.ɵɵelementStart(63, \"strong\")(64, \"a\", 17);\n        i0.ɵɵtext(65, \"Back \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(66, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function ConfigurationComponent_Template_button_click_66_listener() {\n          return ctx.sendCampaign();\n        });\n        i0.ɵɵelementStart(67, \"strong\")(68, \"a\", 17);\n        i0.ɵɵtext(69, \"Send \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(70, \"button\", 19);\n        i0.ɵɵlistener(\"click\", function ConfigurationComponent_Template_button_click_70_listener() {\n          return ctx.redirectToCampignmanagement();\n        });\n        i0.ɵɵelementStart(71, \"strong\")(72, \"a\", 17);\n        i0.ɵɵtext(73, \"Save As Draft\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(74, \"br\");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(45);\n\n        const _r1 = i0.ɵɵreference(52);\n\n        i0.ɵɵadvance(13);\n        i0.ɵɵtextInterpolate(ctx.ConfigShowData.senderEmail);\n        i0.ɵɵadvance(10);\n        i0.ɵɵtextInterpolate1(\" \", ctx.ConfigShowData.configList, \" \");\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate1(\"\", ctx.ConfigShowData.configSubject, \" \");\n        i0.ɵɵadvance(11);\n        i0.ɵɵtextInterpolate1(\"\", ctx.ConfigShowData.templateName, \" \");\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngModel\", ctx.userInfo.testMail);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", _r0.submitted && _r1.invalid || _r1.touched);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.invalidIdFlg == true);\n      }\n    },\n    directives: [i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.NgForm, i5.DefaultValueAccessor, i5.RequiredValidator, i5.NgControlStatus, i5.NgModel, i2.NgIf],\n    styles: [\".w-300[_ngcontent-%COMP%]{width:300px}\"]\n  });\n  return ConfigurationComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}