{"ast":null,"code":"import { formatDate } from \"@angular/common\";\nimport swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/profile-management/profile-services/profile-services.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../auth-services/auth-services.service\";\nimport * as i5 from \"@angular/platform-browser\";\nimport * as i6 from \"src/app/GobalAPIService/global-service-service/PreviewService\";\nimport * as i7 from \"@angular/forms\";\n\nfunction SignInComponent_div_22_div_1_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 36);\n    i0.ɵɵtext(1, \"Please enter username/email address\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SignInComponent_div_22_div_1_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 36);\n    i0.ɵɵtext(1, \" Please enter valid username/email address\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SignInComponent_div_22_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, SignInComponent_div_22_div_1_p_1_Template, 2, 0, \"p\", 35);\n    i0.ɵɵtemplate(2, SignInComponent_div_22_div_1_p_2_Template, 2, 0, \"p\", 35);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext(2);\n\n    const _r1 = i0.ɵɵreference(21);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r1.errors == null ? null : _r1.errors.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r1.errors == null ? null : _r1.errors.pattern);\n  }\n}\n\nfunction SignInComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33);\n    i0.ɵɵtemplate(1, SignInComponent_div_22_div_1_Template, 3, 2, \"div\", 34);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r1 = i0.ɵɵreference(21);\n\n    const _r0 = i0.ɵɵreference(13);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r1.touched || _r0.submitted);\n  }\n}\n\nfunction SignInComponent_div_31_div_1_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 36);\n    i0.ɵɵtext(1, \"Please enter password\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SignInComponent_div_31_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, SignInComponent_div_31_div_1_p_1_Template, 2, 0, \"p\", 35);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext(2);\n\n    const _r3 = i0.ɵɵreference(30);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.required);\n  }\n}\n\nfunction SignInComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37);\n    i0.ɵɵtemplate(1, SignInComponent_div_31_div_1_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r3 = i0.ɵɵreference(30);\n\n    const _r0 = i0.ɵɵreference(13);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r3.touched || _r0.submitted);\n  }\n}\n\nfunction SignInComponent_div_35_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 40);\n    i0.ɵɵtext(1, \" Username or Password is incorrect ! \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SignInComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵtemplate(2, SignInComponent_div_35_p_2_Template, 2, 0, \"p\", 29);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.login == false);\n  }\n}\n\nconst Toast = swal.mixin({\n  toast: true,\n  position: 'top-end',\n  showConfirmButton: false,\n  timer: 2000,\n  timerProgressBar: true,\n  onOpen: toast => {\n    toast.addEventListener('mouseenter', swal.stopTimer);\n    toast.addEventListener('mouseleave', swal.resumeTimer);\n  }\n});\nexport let SignInComponent = /*#__PURE__*/(() => {\n  class SignInComponent {\n    constructor(profileServicesService, router, location, authServicesService, sanitizer, route, previewService) {\n      this.profileServicesService = profileServicesService;\n      this.router = router;\n      this.location = location;\n      this.authServicesService = authServicesService;\n      this.sanitizer = sanitizer;\n      this.route = route;\n      this.previewService = previewService;\n      this.dailySessionInfo = {\n        customerId: \"\",\n        firstName: \"\",\n        lastName: \"\",\n        signIn: \"\",\n        currentStatus: \"\",\n        lastModifiedOn: \"\",\n        comingFrom: \"\",\n        ipAddress: \"\",\n        sessionId: \"\",\n        countryCode: \"\"\n      };\n      this.signinInfo = {\n        email: \"\",\n        password: \"\",\n        firstName: \"\",\n        lastName: \"\"\n      };\n    }\n\n    redirectToForgotPassword() {\n      this.router.navigate(['/forgot-password']);\n    }\n\n    ngOnInit() {\n      this.SeesionIdDate = new Date(); // 2020-04-17T17:19:19.831Z\n\n      this.currentDate = formatDate(new Date(), 'yyyy-MM-dd h:mm:ss', 'en');\n      this.getIP();\n      this.login = true;\n    }\n\n    getIP() {\n      this.authServicesService.getIPAddress().subscribe(res => {\n        this.ipAddress = res.ip;\n        this.getIpDetails(this.ipAddress);\n      });\n    }\n\n    getIpDetails(ipAddress) {\n      let key = \"key=d25tuUTI2XMuXBik\";\n      let resp = this.authServicesService.getIpDetails(ipAddress, key);\n      resp.subscribe(data => {\n        if (data != null && data != \"\") {\n          console.log(data, \"ipdetails before\");\n          this.apDetails = JSON.parse(JSON.stringify(data));\n          console.log(this.apDetails, \"after parsing\");\n          sessionStorage.setItem('timezone', this.apDetails.timezone);\n        }\n      });\n    } // form submit \n\n\n    saveUser(signinForm) {\n      // const user = this.authenticationService.userValue();\n      console.log(\"*******before save user\");\n      let resp = this.authServicesService.serverLogin(this.signinInfo.email, this.signinInfo.password).subscribe({\n        next: () => {\n          console.log(\"after getting token\");\n          this.authServicesService.Login(this.signinInfo.email, this.signinInfo.password).subscribe(data => {\n            console.log(\"inside login\", data);\n\n            if (data != null && data != undefined && data != \"\") {\n              console.log(\"inside login 1\", data);\n              sessionStorage.setItem(\"email\", data.emailAddress);\n              sessionStorage.setItem(\"firstName\", data.firstName);\n              sessionStorage.setItem(\"lastName\", data.lastName);\n              sessionStorage.setItem(\"customerId\", data.customerId);\n              sessionStorage.setItem(\"customerSkey\", data.customerSkey); // sessionStorage.setItem('tokenNo', data.tokenNo); \n\n              sessionStorage.setItem('countryCode', data.countryCode); // this.profileServicesService.setMessage(\"hi\");\n\n              this.DailySession(); // console.log(\"inside login2\",data);\n            } else {\n              this.login = false; // Toast.fire({\n              //   icon: 'error',\n              //   title: 'Login Failed'\n              // })\n            }\n          });\n        }\n      });\n\n      if (resp) {\n        console.log(this.previewService.getloginFlag);\n        this.login = this.previewService.getloginFlag;\n      }\n    }\n\n    restmsg() {\n      this.login = true;\n    }\n\n    DailySession() {\n      this.dailySessionInfo.customerId = sessionStorage.getItem(\"customerId\");\n      this.dailySessionInfo.firstName = sessionStorage.getItem(\"firstName\");\n      this.dailySessionInfo.lastName = sessionStorage.getItem(\"lastName\");\n      this.dailySessionInfo.signIn = this.currentDate;\n      this.dailySessionInfo.currentStatus = \"Active\";\n      this.dailySessionInfo.comingFrom = \"Samrt Digital\";\n      this.dailySessionInfo.sessionId = this.SeesionIdDate.getTime();\n      this.dailySessionInfo.ipAddress = this.ipAddress;\n      this.dailySessionInfo.lastModifiedOn = this.currentDate;\n      this.dailySessionInfo.countryCode = sessionStorage.getItem(\"countryCode\"); // console.log(\"inside daily session\");\n\n      let resp = this.authServicesService.UpdateDailySession(this.dailySessionInfo);\n      resp.subscribe(data => {\n        console.log(\"inside daily session\", data);\n\n        if (data != null && data != \"\") {\n          sessionStorage.setItem(\"dailySessionKey\", data);\n          this.router.navigate(['/dashboard']); // return resolveSanitizationFn;\n          // console.log(this.router.navigate(['/dashboard']).);\n\n          Toast.fire({\n            icon: 'success',\n            title: 'Welcome ' + sessionStorage.getItem(\"firstName\")\n          });\n        }\n      });\n    } // user name Text box space remove function \n\n\n    onKeydown(event) {\n      if (event.keyCode === 32) {\n        return false;\n      }\n    }\n\n    signIn() {\n      if (sessionStorage.getItem(\"firstName\") != null && sessionStorage.getItem(\"firstName\") != \"\" && sessionStorage.getItem(\"firstName\") != undefined && sessionStorage.getItem(\"lastName\") != null && sessionStorage.getItem(\"lastName\") != \"\" && sessionStorage.getItem(\"lastName\") != undefined) {\n        this.profileServicesService.setMessage(\"hi\");\n        this.router.navigate(['/dashboard']);\n      } else {\n        this.authServicesService.redirectToLogin();\n        Toast.fire({\n          icon: 'error',\n          title: 'Session expired'\n        });\n      }\n    }\n\n    redirectToSignUp() {\n      this.router.navigate(['/sign-up']);\n    }\n\n  }\n\n  SignInComponent.ɵfac = function SignInComponent_Factory(t) {\n    return new (t || SignInComponent)(i0.ɵɵdirectiveInject(i1.ProfileServicesService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.Location), i0.ɵɵdirectiveInject(i4.AuthServicesService), i0.ɵɵdirectiveInject(i5.DomSanitizer), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i6.PreviewService));\n  };\n\n  SignInComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SignInComponent,\n    selectors: [[\"app-sign-in\"]],\n    decls: 44,\n    vars: 5,\n    consts: [[1, \"row\", \"mt-10\"], [1, \"col-md-4\", \"offset-md-4\"], [1, \"card\", \"form-bg\", \"box-shadow\"], [1, \"card-header\", \"bg-white\", \"text-center\"], [\"href\", \"https://markzil.com/\", \"target\", \"_blank\", \"tabindex\", \"1\"], [\"src\", \"assets/images/Markzil-1 Cut.png\", \"alt\", \"Emanzo\", \"width\", \"40%\", 1, \"img-rounded\", \"logoDesign\", \"ml-20\"], [\"href\", \"https://markzil.com/\", \"target\", \"_blank\", \"tabindex\", \"2\"], [\"aria-hidden\", \"true\", 1, \"mt-3\", \"fa\", \"fa-home\", \"info\", \"pull-right\", \"font-20\", \"text-danger\"], [1, \"formHeading\", \"text-center\", \"text-secondary\", \"mt-4\"], [1, \"card-body\"], [\"novalidate\", \"\", 3, \"ngSubmit\"], [\"signinForm\", \"ngForm\"], [1, \"input-group\", \"form-group\", \"pr-3\", \"pb-3\"], [1, \"pr-1\", \"pt-1\", \"font\"], [1, \"input-group-prepend\"], [1, \"input-group-text\", \"bg-danger\", \"text-light\"], [1, \"fa\", \"fa-user\"], [\"id\", \"inputEmail\", \"type\", \"email\", \"name\", \"email\", \"required\", \"\", \"pattern\", \"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\\\.[A-Za-z]{2,5}$\", 1, \"form-control\", \"removeInvalid\", 3, \"ngModel\", \"ngModelChange\", \"keydown\", \"change\"], [\"email\", \"ngModel\"], [\"class\", \"col-md-12 text-center\", 4, \"ngIf\"], [1, \"input-group\", \"form-group\", \"pr-3\"], [1, \"pr-4\", \"mr-2\", \"pt-1\", \"font\"], [1, \"fa\", \"fa-unlock-alt\"], [\"id\", \"inputPassword\", \"type\", \"password\", \"name\", \"password\", \"required\", \"\", 1, \"form-control\", \"removeInvalid\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"password\", \"ngModel\"], [\"class\", \"col-md-12 ml-4 pl-4\", 4, \"ngIf\"], [2, \"color\", \"red\", \"text-align\", \"left\"], [1, \"form-group\", \"text-center\", \"mt-4\"], [\"type\", \"submit\", \"value\", \"Sign In\", 1, \"btn\", \"btn-info\", \"bold\", \"mg-t-10\"], [\"class\", \"col-md-12 help-box\", 4, \"ngIf\"], [1, \"card-footer\"], [1, \"text-center\", \"p-2\"], [1, \"cursor\", 3, \"click\"], [1, \"col-md-12\", \"text-center\"], [4, \"ngIf\"], [\"class\", \"help-box\", 4, \"ngIf\"], [1, \"help-box\"], [1, \"col-md-12\", \"ml-4\", \"pl-4\"], [\"class\", \"ml-4 pl-4\", 4, \"ngIf\"], [1, \"ml-4\", \"pl-4\"], [1, \"col-md-12\", \"help-box\"]],\n    template: function SignInComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r12 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"a\", 4);\n        i0.ɵɵelement(5, \"img\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"a\", 6);\n        i0.ɵɵelement(7, \"i\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"h3\", 8)(9, \"strong\");\n        i0.ɵɵtext(10, \"Sign In \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(11, \"div\", 9)(12, \"form\", 10, 11);\n        i0.ɵɵlistener(\"ngSubmit\", function SignInComponent_Template_form_ngSubmit_12_listener() {\n          i0.ɵɵrestoreView(_r12);\n\n          const _r0 = i0.ɵɵreference(13);\n\n          return _r0.form.valid && ctx.saveUser(_r0);\n        });\n        i0.ɵɵelementStart(14, \"div\", 12)(15, \"label\", 13);\n        i0.ɵɵtext(16, \"Email Address\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"div\", 14)(18, \"span\", 15);\n        i0.ɵɵelement(19, \"i\", 16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"input\", 17, 18);\n        i0.ɵɵlistener(\"ngModelChange\", function SignInComponent_Template_input_ngModelChange_20_listener($event) {\n          return ctx.signinInfo.email = $event;\n        })(\"keydown\", function SignInComponent_Template_input_keydown_20_listener($event) {\n          return ctx.onKeydown($event);\n        })(\"change\", function SignInComponent_Template_input_change_20_listener() {\n          return ctx.restmsg();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(22, SignInComponent_div_22_Template, 2, 1, \"div\", 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"div\", 20)(24, \"label\", 21);\n        i0.ɵɵtext(25, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\", 14)(27, \"span\", 15);\n        i0.ɵɵelement(28, \"i\", 22);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(29, \"input\", 23, 24);\n        i0.ɵɵlistener(\"ngModelChange\", function SignInComponent_Template_input_ngModelChange_29_listener($event) {\n          return ctx.signinInfo.password = $event;\n        })(\"change\", function SignInComponent_Template_input_change_29_listener() {\n          return ctx.restmsg();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(31, SignInComponent_div_31_Template, 2, 1, \"div\", 25);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(32, \"p\", 26);\n        i0.ɵɵelementStart(33, \"div\", 27);\n        i0.ɵɵelement(34, \"input\", 28);\n        i0.ɵɵtemplate(35, SignInComponent_div_35_Template, 3, 1, \"div\", 29);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(36, \"div\", 30)(37, \"div\", 31)(38, \"a\", 32);\n        i0.ɵɵlistener(\"click\", function SignInComponent_Template_a_click_38_listener() {\n          return ctx.redirectToForgotPassword();\n        });\n        i0.ɵɵtext(39, \" Forgot your password?\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(40, \"div\", 31);\n        i0.ɵɵtext(41, \" Not a member? \");\n        i0.ɵɵelementStart(42, \"a\", 32);\n        i0.ɵɵlistener(\"click\", function SignInComponent_Template_a_click_42_listener() {\n          return ctx.redirectToSignUp();\n        });\n        i0.ɵɵtext(43, \" Sign Up\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(13);\n\n        const _r1 = i0.ɵɵreference(21);\n\n        const _r3 = i0.ɵɵreference(30);\n\n        i0.ɵɵadvance(20);\n        i0.ɵɵproperty(\"ngModel\", ctx.signinInfo.email);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r0.submitted && _r1.invalid || _r1.touched);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.signinInfo.password);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r0.submitted && _r3.invalid || _r3.touched);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", _r0.submitted);\n      }\n    },\n    directives: [i7.ɵNgNoValidate, i7.NgControlStatusGroup, i7.NgForm, i7.DefaultValueAccessor, i7.RequiredValidator, i7.PatternValidator, i7.NgControlStatus, i7.NgModel, i3.NgIf],\n    styles: [\".mt-10[_ngcontent-%COMP%]{margin-top:10%}.font[_ngcontent-%COMP%]{font-size:small}\"]\n  });\n  return SignInComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}